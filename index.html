<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a472a">
    <title>Tennis Match Recorder</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <button class="nav-back hidden" id="back-button">
            <span>‚Üê</span>
        </button>
        <h1 class="nav-title" id="page-title">Matches</h1>
        <button class="nav-action" id="add-button" data-action="add-match">
            <span>+</span>
        </button>
    </nav>

    <!-- Main App Container -->
    <div id="app">
        <!-- Matches Page -->
        <div id="matches-page" class="page active">
            <div class="matches-list" id="matches-list">
                <!-- Matches will be loaded here -->
            </div>
            <div class="empty-state hidden" id="matches-empty">
                <p>No matches recorded yet</p>
                <button class="btn-primary" onclick="app.showPage('new-match')">Record First Match</button>
            </div>
        </div>

        <!-- Players Page -->
        <div id="players-page" class="page">
            <div class="players-list" id="players-list">
                <!-- Players will be loaded here -->
            </div>
            <div class="empty-state hidden" id="players-empty">
                <p>No players added yet</p>
                <button class="btn-primary" onclick="playerManager.showNewPlayerForm()">Add First Player</button>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page">
            <div class="settings-content">
                <section class="settings-section">
                    <h2>GitHub Sync</h2>
                    <div class="setting-item">
                        <label>GitHub Token</label>
                        <input type="password" id="github-token" placeholder="Enter GitHub Personal Access Token">
                        <small>Create token at: github.com/settings/tokens</small>
                    </div>
                    <div class="setting-item">
                        <label>Repository Name</label>
                        <input type="text" id="github-repo" placeholder="tennis-match-data">
                    </div>
                    <button class="btn-primary" id="sync-button">Sync Now</button>
                    <div id="sync-status"></div>
                </section>
                <section class="settings-section">
                    <h2>Data Management</h2>
                    <button class="btn-secondary" id="export-button">Export Data</button>
                    <button class="btn-secondary" id="import-button">Import Data</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                </section>
            </div>
        </div>

        <!-- New/Edit Player Page -->
        <div id="player-form-page" class="page">
            <div class="form-container">
                <h2 id="player-form-title">Add Player</h2>
                <form id="player-form">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" id="player-name" required>
                    </div>
                    <div class="form-group">
                        <label>Handedness *</label>
                        <select id="player-handedness" required>
                            <option value="righty">Righty</option>
                            <option value="lefty">Lefty</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Backhand Stroke Preference *</label>
                        <select id="player-backhand" required>
                            <option value="Single Hand">Single Hand</option>
                            <option value="Double Hand">Double Hand</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>UTR Rating (optional)</label>
                        <input type="number" id="player-utr" min="1" max="16.5" step="0.5">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="app.showPage('players')">Cancel</button>
                        <button type="submit" class="btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- New Match Settings Page -->
        <div id="new-match-page" class="page">
            <div class="form-container">
                <h2>New Match</h2>
                <form id="match-settings-form">
                    <div class="form-group">
                        <label>Player 1 *</label>
                        <select id="match-player1" required>
                            <option value="">Select Player 1</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Player 2 *</label>
                        <select id="match-player2" required>
                            <option value="">Select Player 2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>First Server *</label>
                        <select id="match-first-server" required>
                            <option value="player1">Player 1</option>
                            <option value="player2">Player 2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Number of Sets *</label>
                        <select id="match-sets" required>
                            <option value="1">1 Set</option>
                            <option value="2">2 Sets</option>
                            <option value="3" selected>3 Sets</option>
                            <option value="4">4 Sets</option>
                            <option value="5">5 Sets</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Games per Set *</label>
                        <select id="match-games" required>
                            <option value="1">1 Game</option>
                            <option value="2">2 Games</option>
                            <option value="3">3 Games</option>
                            <option value="4">4 Games</option>
                            <option value="5">5 Games</option>
                            <option value="6" selected>6 Games</option>
                            <option value="7">7 Games</option>
                            <option value="8">8 Games</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="match-ad-scoring" checked>
                            Ad Scoring
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Final Set Type *</label>
                        <select id="match-final-set" required>
                            <option value="Normal Final Set">Normal Final Set</option>
                            <option value="Super Tie Break">Super Tie Break</option>
                        </select>
                    </div>
                    <div class="form-group" id="tie-break-group">
                        <label>Tie Break Games *</label>
                        <select id="match-tie-break-games" required>
                            <option value="5">5 Points</option>
                            <option value="7" selected>7 Points</option>
                            <option value="10">10 Points</option>
                        </select>
                    </div>
                    <div class="form-group" id="tie-break-winby2-group">
                        <label>
                            <input type="checkbox" id="match-tie-break-winby2" checked>
                            Win by 2 Points
                        </label>
                    </div>
                    <div class="form-group" id="super-tie-break-group" style="display: none;">
                        <label>Super Tie Break Points *</label>
                        <select id="match-super-tie-break-points">
                            <option value="5">5 Points</option>
                            <option value="7" selected>7 Points</option>
                            <option value="10">10 Points</option>
                            <option value="12">12 Points</option>
                        </select>
                    </div>
                    <div class="form-group" id="super-tie-break-winby2-group" style="display: none;">
                        <label>
                            <input type="checkbox" id="match-super-tie-break-winby2" checked>
                            Win by 2 Points
                        </label>
                    </div>
                    <div class="form-group">
                        <label>Court Type *</label>
                        <select id="match-court-type" required>
                            <option value="Grass">Grass</option>
                            <option value="Clay">Clay</option>
                            <option value="Hard" selected>Hard</option>
                            <option value="Carpet">Carpet</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="match-indoor">
                            Indoor
                        </label>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="app.showPage('matches')">Cancel</button>
                        <button type="submit" class="btn-primary">Start Match</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Match Recording Page -->
        <div id="match-recording-page" class="page">
            <div class="live-match-container">
                <!-- Header -->
                <div class="live-match-header">
                    <h2>Live Match</h2>
                    <button class="menu-btn" id="match-menu-btn">‚ãØ</button>
                </div>

                <!-- Players Header -->
                <div class="players-header">
                    <div class="player-header-left">
                        <div class="player-name-large" id="player1-name">Player 1</div>
                    </div>
                    <div class="set-score-badge" id="set-score-badge">
                        <div>1</div>
                        <div>0-0</div>
                    </div>
                    <div class="player-header-right">
                        <div class="player-name-large" id="player2-name">Player 2</div>
                    </div>
                </div>

                <!-- Current Game Score -->
                <div class="current-game-score">
                    <div class="game-score-left">
                        <div class="game-score-value" id="player1-game-score">0</div>
                        <div class="player-name-under-score" id="player1-name-under">Player 1</div>
                        <div class="serve-indicator-under" id="player1-serve-under">
                            <span class="tennis-ball-small">üéæ</span>
                            <span class="tennis-ball-small">üéæ</span>
                        </div>
                    </div>
                    <div class="game-score-divider"></div>
                    <div class="game-score-right">
                        <div class="game-score-value" id="player2-game-score">0</div>
                        <div class="player-name-under-score" id="player2-name-under">Player 2</div>
                        <div class="serve-indicator-under" id="player2-serve-under">
                            <span class="tennis-ball-small">üéæ</span>
                            <span class="tennis-ball-small">üéæ</span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons - Left Side (Player 1) -->
                <div class="action-buttons-container">
                    <div class="player-buttons-left">
                        <!-- Player 1 as Server -->
                        <div class="server-buttons hidden" id="player1-server-buttons">
                            <button class="action-btn error-btn" data-action="serve-fault" data-player="player1">SERVE FAULT</button>
                            <div class="button-row">
                                <button class="action-btn success-btn" data-action="ace" data-player="player1">ACE</button>
                                <button class="action-btn success-btn" data-action="winner" data-player="player1">WINNER</button>
                            </div>
                            <button class="action-btn error-btn" data-action="unforced-error" data-player="player1">UNFORCED ERROR</button>
                            <button class="action-btn error-btn" data-action="forced-error" data-player="player1">FORCED ERROR</button>
                        </div>
                        <!-- Player 1 as Receiver -->
                        <div class="receiver-buttons hidden" id="player1-receiver-buttons">
                            <button class="action-btn error-btn" data-action="return-error" data-player="player1">RETURN ERROR</button>
                            <button class="action-btn success-btn" data-action="receiver-winner" data-player="player1">WINNER</button>
                            <button class="action-btn error-btn" data-action="receiver-unforced-error" data-player="player1">UNFORCED ERROR</button>
                            <button class="action-btn error-btn" data-action="receiver-forced-error" data-player="player1">FORCED ERROR</button>
                        </div>
                    </div>

                    <div class="player-buttons-right">
                        <!-- Player 2 as Server -->
                        <div class="server-buttons hidden" id="player2-server-buttons">
                            <button class="action-btn error-btn" data-action="serve-fault" data-player="player2">SERVE FAULT</button>
                            <div class="button-row">
                                <button class="action-btn success-btn" data-action="ace" data-player="player2">ACE</button>
                                <button class="action-btn success-btn" data-action="winner" data-player="player2">WINNER</button>
                            </div>
                            <button class="action-btn error-btn" data-action="unforced-error" data-player="player2">UNFORCED ERROR</button>
                            <button class="action-btn error-btn" data-action="forced-error" data-player="player2">FORCED ERROR</button>
                        </div>
                        <!-- Player 2 as Receiver -->
                        <div class="receiver-buttons hidden" id="player2-receiver-buttons">
                            <button class="action-btn error-btn" data-action="return-error" data-player="player2">RETURN ERROR</button>
                            <button class="action-btn success-btn" data-action="receiver-winner" data-player="player2">WINNER</button>
                            <button class="action-btn error-btn" data-action="receiver-unforced-error" data-player="player2">UNFORCED ERROR</button>
                            <button class="action-btn error-btn" data-action="receiver-forced-error" data-player="player2">FORCED ERROR</button>
                        </div>
                    </div>
                </div>

                <!-- Undo Button -->
                <button class="undo-btn" id="undo-btn">
                    <span class="undo-icon">‚Ü∂</span>
                    <span>UNDO</span>
                </button>
            </div>
        </div>

        <!-- Match Detail Page -->
        <div id="match-detail-page" class="page">
            <div class="match-detail-container" id="match-detail-content">
                <!-- Match details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Bottom Tab Navigation -->
    <nav class="tab-bar">
        <button class="tab-button active" data-page="matches">
            <span class="tab-icon">üéæ</span>
            <span class="tab-label">Matches</span>
        </button>
        <button class="tab-button" data-page="players">
            <span class="tab-icon">üë•</span>
            <span class="tab-label">Players</span>
        </button>
        <button class="tab-button" data-page="settings">
            <span class="tab-icon">‚öôÔ∏è</span>
            <span class="tab-label">Settings</span>
        </button>
    </nav>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden"></div>

    <!-- Scripts -->
    <script src="js/models.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/match-engine.js"></script>
    <script src="js/player-manager.js"></script>
    <script src="js/match-recorder.js"></script>
    <script src="js/github-sync.js"></script>
    <script src="js/app.js"></script>
</body>
</html>

